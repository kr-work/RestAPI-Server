CREATE OR REPLACE FUNCTION notify_state_update()
RETURNS trigger AS $$
BEGIN
    PERFORM pg_notify('state_update', NEW.match_id::text);
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER state_update_trigger
    AFTER INSERT ON state
    FOR EACH ROW
EXECUTE FUNCTION notify_state_update();

